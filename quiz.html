<!DOCTYPE html>
<html lang="zh-TW">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>å–®å­—æ¸¬é©—é€²è¡Œä¸­</title>
Â  Â  <style>
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  Â  Â  Â  background-color: #f4f7f6;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .quiz-container {
Â  Â  Â  Â  Â  Â  max-width: 600px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  h2 {
Â  Â  Â  Â  Â  Â  color: #007bff;
Â  Â  Â  Â  Â  Â  margin-top: 0;
Â  Â  Â  Â  }
Â  Â  Â  Â  .question-box {
Â  Â  Â  Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  background-color: #fff;
Â  Â  Â  Â  }
Â  Â  Â  Â  .question-text {
Â  Â  Â  Â  Â  Â  font-size: 1.2em;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  }
Â  Â  Â  Â  
        /* æŒ‰éˆ•äº’å‹•å’Œå›é¥‹æ¨£å¼ */
Â  Â  Â  Â  .options-list button {
            transition: background-color 0.2s; 
Â  Â  Â  Â  }
Â  Â  Â  Â  .options-list button:hover:not(:disabled) {
Â  Â  Â  Â  Â  Â  background-color: #d8dadf !important;
Â  Â  Â  Â  }
Â  Â  Â  Â  .options-list button.correct {
Â  Â  Â  Â  Â  Â  background-color: #28a745 !important; /* ç¶ è‰² */
Â  Â  Â  Â  Â  Â  color: white !important;
Â  Â  Â  Â  Â  Â  border-color: #28a745 !important;
Â  Â  Â  Â  }
Â  Â  Â  Â  .options-list button.wrong {
Â  Â  Â  Â  Â  Â  background-color: #dc3545 !important; /* ç´…è‰² */
Â  Â  Â  Â  Â  Â  color: white !important;
Â  Â  Â  Â  Â  Â  border-color: #dc3545 !important;
Â  Â  Â  Â  }
Â  Â  Â  Â  .feedback {
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  font-size: 1em;
Â  Â  Â  Â  Â  Â  display: none; 
Â  Â  Â  Â  }
Â  Â  Â  Â  .feedback.show {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  }
Â  Â  Â  Â  .next-button {
Â  Â  Â  Â  Â  Â  background-color: #ffc107;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .submit-button {
Â  Â  Â  Â  Â  Â  background-color: #007bff; /* æ–°å¢çš„äº¤å·æŒ‰éˆ•æ¨£å¼ */
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  margin-top: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .back-button {
Â  Â  Â  Â  Â  Â  background-color: #6c757d;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  margin-top: 10px;
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

Â  Â  <div class="quiz-container">
Â  Â  Â  Â  <h2 id="quiz-title">å–®é€±æ¸¬é©—</h2>
Â  Â  Â  Â  <div id="question-number">è¼‰å…¥ä¸­...</div>

Â  Â  Â  Â  <div id="quiz-area">
Â  Â  Â  Â  Â  Â  <p>æ­£åœ¨è¼‰å…¥é¡Œç›®ï¼Œè«‹ç¨å€™...</p>
Â  Â  Â  Â  Â  Â  <div style="display: none;" id="data-error-message">
                <p>éŒ¯èª¤ï¼šæ•¸æ“šè¼‰å…¥å¤±æ•—ï¼è«‹ç¢ºä¿æ‚¨å·²å¾é¸å–®é é¢ (index.html) é»æ“Šé–‹å§‹æ¸¬é©—ã€‚</p>
            </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  
Â  Â  Â  Â  <button class="next-button" id="next-btn" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ</button>
        <button class="submit-button" id="submit-btn" onclick="finishQuiz()">æå‰äº¤å· / çµæŸæ¸¬é©—</button>
Â  Â  Â  Â  <button class="back-button" onclick="window.location.href='index.html'">å›é¸å–®é é¢</button>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  let currentQuestions = [];
Â  Â  Â  Â  let currentQuestionIndex = 0;
Â  Â  Â  Â  let quizWeek = null;
        let score = 0; // æ–°å¢ï¼šåˆ†æ•¸è¨ˆæ•¸å™¨

Â  Â  Â  Â  function loadQuiz() {
Â  Â  Â  Â  Â  Â  const quizDataJSON = sessionStorage.getItem('currentQuizData');
Â  Â  Â  Â  Â  Â  quizWeek = sessionStorage.getItem('currentQuizWeek');

Â  Â  Â  Â  Â  Â  if (!quizDataJSON || !quizWeek) {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('quiz-title').textContent = 'éŒ¯èª¤ï¼šæ•¸æ“šè¼‰å…¥å¤±æ•—ï¼';
                document.getElementById('data-error-message').style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('quiz-area').innerHTML = '';
                document.getElementById('next-btn').style.display = 'none';
                document.getElementById('submit-btn').style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  document.getElementById('quiz-title').textContent = `å–®é€± ${quizWeek} æ¸¬é©—`;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const allQuestions = JSON.parse(quizDataJSON);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // å°‡é¡Œç›®è¨­è¨ˆç‚ºï¼šå¾è‹±æ–‡é¸ä¸­æ–‡è§£é‡‹ (ä¿æŒå¾ index.html ç¹¼æ‰¿çš„é‚è¼¯)
Â  Â  Â  Â  Â  Â  const transformedQuestions = allQuestions.map(item => {
                const questionText = `Choose the correct Chinese translation for the English word: **${item.word}**`;
                return {
                    question: questionText,
                    correctAnswer: item.definition,
                    distractors: item.distractors 
                };
            });
            
Â  Â  Â  Â  Â  Â  // éš¨æ©Ÿæ’åºæ‰€æœ‰é¡Œç›®
Â  Â  Â  Â  Â  Â  currentQuestions = transformedQuestions.sort(() => 0.5 - Math.random()); 
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  currentQuestionIndex = 0;
Â  Â  Â  Â  Â  Â  displayQuestion();
Â  Â  Â  Â  }

Â  Â  Â  Â  function displayQuestion() {
Â  Â  Â  Â  Â  Â  if (currentQuestionIndex >= currentQuestions.length) {
Â  Â  Â  Â  Â  Â  Â  Â  // æ¸¬é©—çµæŸ (é¡Œç›®ç­”å®Œæ™‚)
Â  Â  Â  Â  Â  Â  Â  Â  finishQuiz(true); 
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const q = currentQuestions[currentQuestionIndex];
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // å°‡æ­£ç¢ºç­”æ¡ˆå’Œå¹²æ“¾é …æ··åˆï¼Œä¸¦éš¨æ©Ÿæ’åˆ—é¸é …
Â  Â  Â  Â  Â  Â  const allOptions = [q.correctAnswer, ...q.distractors].sort(() => 0.5 - Math.random());

Â  Â  Â  Â  Â  Â  let html = `<div class="question-box">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="question-text">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${q.question}
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="options-list">`;

Â  Â  Â  Â  Â  Â  // ç”Ÿæˆé¸é …æŒ‰éˆ• (ä½¿ç”¨ Inline Style å¼·åˆ¶æ¨£å¼)
Â  Â  Â  Â  Â  Â  allOptions.forEach(option => {
Â  Â  Â  Â  Â  Â  Â  Â  const safeOption = option.replace(/'/g, "\\'");
Â  Â  Â  Â  Â  Â  Â  Â  const safeCorrectAnswer = q.correctAnswer.replace(/'/g, "\\'");

Â  Â  Â  Â  Â  Â  Â  Â  html += `<button 
                    style="display: block; width: 100%; padding: 30px 35px; margin-bottom: 15px; 
                           background-color: #e9ecef; border: 2px solid #adb5bd; border-radius: 10px; 
                           text-align: left; cursor: pointer; font-size: 1.4em; font-weight: bold; "
                    onclick="checkAnswer(this, '${safeOption}', '${safeCorrectAnswer}')">
                    ${option}
                </button>`;
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  html += `</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="feedback" id="feedback-${currentQuestionIndex}"></div>
Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  document.getElementById('quiz-area').innerHTML = html;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  document.getElementById('question-number').textContent = `ç¬¬ ${currentQuestionIndex + 1} é¡Œ / å…± ${currentQuestions.length} é¡Œ`;
Â  Â  Â  Â  Â  Â  document.getElementById('next-btn').disabled = true; 
Â  Â  Â  Â  }

Â  Â  Â  Â  function checkAnswer(button, selectedAnswer, correctAnswer) {
Â  Â  Â  Â  Â  Â  // ç¦ç”¨æ‰€æœ‰æŒ‰éˆ•é˜²æ­¢é‡è¤‡é»æ“Š
Â  Â  Â  Â  Â  Â  const buttons = document.querySelectorAll('.options-list button');
Â  Â  Â  Â  Â  Â  buttons.forEach(btn => btn.disabled = true);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const feedbackDiv = document.getElementById(`feedback-${currentQuestionIndex}`);
Â  Â  Â  Â  Â  Â  feedbackDiv.classList.add('show');
Â  Â  Â  Â  Â  Â  document.getElementById('next-btn').disabled = false; 
            
            // æª¢æŸ¥ç­”æ¡ˆä¸¦è¨ˆåˆ†
Â  Â  Â  Â  Â  Â  if (selectedAnswer === correctAnswer) {
Â  Â  Â  Â  Â  Â  Â  Â  button.classList.add('correct');
Â  Â  Â  Â  Â  Â  Â  Â  feedbackDiv.innerHTML = 'âœ… **ç­”å°äº†ï¼**';
Â  Â  Â  Â  Â  Â  Â  Â  feedbackDiv.style.backgroundColor = '#d4edda'; 
                score++; // ç­”å°äº†ï¼Œåˆ†æ•¸å¢åŠ 
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  button.classList.add('wrong');
Â  Â  Â  Â  Â  Â  Â  Â  feedbackDiv.innerHTML = `âŒ **ç­”éŒ¯äº†ï¼** æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š**${correctAnswer}**`;
Â  Â  Â  Â  Â  Â  Â  Â  feedbackDiv.style.backgroundColor = '#f8d7da'; 
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  // æ‰¾å‡ºæ­£ç¢ºç­”æ¡ˆçš„æŒ‰éˆ•ä¸¦æ¨™è¨˜
Â  Â  Â  Â  Â  Â  Â  Â  buttons.forEach(btn => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (btn.textContent === correctAnswer) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.add('correct');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function nextQuestion() {
Â  Â  Â  Â  Â  Â  currentQuestionIndex++;
Â  Â  Â  Â  Â  Â  displayQuestion();
Â  Â  Â  Â  }
        
        // **æ–°å¢ï¼šæå‰äº¤å· / çµæŸæ¸¬é©— å‡½æ•¸**
        function finishQuiz(completed = false) {
            // è¨ˆç®—ç¸½å…±å›ç­”äº†å¤šå°‘é¡Œ (å·²å®Œæˆé¡Œè™Ÿ - 1)
            const answeredCount = currentQuestionIndex; 
            const totalQuestions = currentQuestions.length;
            
            let message = '';
            
            if (completed) {
                // å¦‚æœæ˜¯ç­”å®Œæ‰€æœ‰é¡Œç›®
                message = `<h3>ğŸ‰ æ¸¬é©—å®Œæˆï¼</h3><p>æ‚¨æˆåŠŸå®Œæˆäº†**${totalQuestions}**é¡Œæ¸¬é©—ã€‚</p>`;
            } else {
                // å¦‚æœæ˜¯æå‰äº¤å·
                const confirmSubmit = confirm(`æ‚¨ç¢ºå®šè¦æå‰äº¤å·å—ï¼Ÿ\n\nç›®å‰å·²ä½œç­” ${answeredCount} é¡Œï¼Œå‰©é¤˜ ${totalQuestions - answeredCount} é¡Œæœªä½œç­”ã€‚`);
                if (!confirmSubmit) {
                    return; // ä½¿ç”¨è€…å–æ¶ˆäº¤å·
                }
                message = `<h3>ğŸ“ æå‰äº¤å·</h3><p>æ‚¨ä½œç­”äº† **${answeredCount}** é¡Œï¼Œå‰©é¤˜ **${totalQuestions - answeredCount}** é¡Œæœªä½œç­”ã€‚</p>`;
            }

            // é¡¯ç¤ºæœ€çµ‚çµæœ
            document.getElementById('quiz-area').innerHTML = `
                ${message}
                <h4>æ‚¨çš„æœ€çµ‚æˆç¸¾ï¼š</h4>
                <p style="font-size: 1.5em; font-weight: bold; color: ${score >= answeredCount * 0.8 ? '#28a745' : '#dc3545'};">
                    æ­£ç¢ºé¡Œæ•¸ï¼š${score} é¡Œ / ç¸½ä½œç­”æ•¸ï¼š${answeredCount} é¡Œ
                </p>
                <p>æ­£ç¢ºç‡ï¼š${answeredCount > 0 ? (score / answeredCount * 100).toFixed(1) : 0}%</p>
                <p>æ„Ÿè¬æ‚¨çš„åƒèˆ‡ï¼è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•å›é¸å–®é é¢ã€‚</p>
            `;

            // éš±è—ä¸å¿…è¦çš„æŒ‰éˆ•å’Œè³‡è¨Š
            document.getElementById('next-btn').style.display = 'none';
            document.getElementById('submit-btn').style.display = 'none';
            document.getElementById('question-number').style.display = 'none';
        }


Â  Â  Â  Â  window.onload = loadQuiz;
Â  Â  </script>
</body>
</html>